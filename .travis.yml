language: cpp
python: 
  - "3.6"
dist: focal
compiler:
  - gcc
os:
  - linux
before_install:
  # NOTE, Alternative way to install latest cmake
  # - sudo apt-get -y install apt-transport-https ca-certificates gnupg software-properties-common wget
  # - wget -O - https://apt.kitware.com/keys/kitware-archive-latest.asc 2>/dev/null | gpg --dearmor - | sudo tee /etc/apt/trusted.gpg.d/kitware.gpg >/dev/null
  # - sudo apt-add-repository -y 'deb https://apt.kitware.com/ubuntu/ bionic main'
  # - sudo apt-get -y install cmake
  - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
  - pip install cmake gcovr
addons:
  apt:
    update: true
    packages:
      - doxygen
      - graphviz
      - ninja-build
      - gcc-9
      - g++-9
script:
  # Information
  - python --version
  - pip --version
  - cmake --version
  - ninja --version
  - gcc-9 --version
  - doxygen --version
  - gcovr --version
  # Start Script
  # Doxygen Generator
  - mkdir docs
  - doxygen Doxyfile
  # C Build
  - cd C
  - cmake -DCMAKE_C_COMPILER:FILEPATH=/usr/bin/gcc-9 -DCMAKE_CXX_COMPILER:FILEPATH=/usr/bin/g++-9 -B build -S . -G Ninja
  - cmake --build build --config Debug --target all
  - cd build
  - ctest -C Debug -T test --output-on-failure
  - cd ../
  # C Code Coverage
  - cmake --build build --target coverage
  - cd ../
  - cp -r C/build/coverage docs/html/c_coverage/.
  - ls -la docs/html/c_coverage/
  # TODO, Add C++ Build 
deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  keep_history: true
  on:
    branch: master
branches:
  only:
  - master
